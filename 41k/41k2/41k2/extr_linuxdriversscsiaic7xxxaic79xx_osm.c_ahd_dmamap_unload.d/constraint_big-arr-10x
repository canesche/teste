value(dmat) == 10, value(map) == 10, length(ahd) == 100