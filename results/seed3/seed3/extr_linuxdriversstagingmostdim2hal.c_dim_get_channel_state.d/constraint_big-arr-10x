length(ch) == 100, length(state_ptr) == 100