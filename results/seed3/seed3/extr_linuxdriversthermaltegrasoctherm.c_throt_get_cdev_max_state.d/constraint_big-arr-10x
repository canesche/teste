length(max_state) == 100, length(cdev) == 100