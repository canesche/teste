value(buflen) == 255, value(state) == 255, length(buffer) == 65025, length(rgd) == 65025