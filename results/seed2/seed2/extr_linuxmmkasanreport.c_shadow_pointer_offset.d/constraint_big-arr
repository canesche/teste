length(row) == 65025, length(shadow) == 65025