length(gate) == 100, length(d) == 100