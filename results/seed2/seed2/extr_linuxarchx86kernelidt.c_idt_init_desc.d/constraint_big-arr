length(gate) == 65025, length(d) == 65025