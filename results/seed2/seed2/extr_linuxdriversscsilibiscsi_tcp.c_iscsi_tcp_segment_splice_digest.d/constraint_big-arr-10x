length(digest) == 100, length(segment) == 100