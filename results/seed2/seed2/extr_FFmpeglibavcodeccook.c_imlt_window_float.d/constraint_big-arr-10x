length(inbuffer) == 100, length(previous_buffer) == 100, length(q) == 100, length(gains_ptr) == 100