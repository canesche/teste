length(di) == 100, length(checkpoint) == 100