length(nn) == 65025, length(ddir) == 65025